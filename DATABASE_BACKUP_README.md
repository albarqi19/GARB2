# إدارة النسخ الاحتياطية لقاعدة البيانات

## نظرة عامة
يحتوي هذا المجلد على ملفات PowerShell لإدارة النسخ الاحتياطية لقاعدة بيانات مشروع غرب.

## الملفات المتاحة

### 1. backup_database.ps1
**الوظيفة:** أخذ نسخة احتياطية من قاعدة البيانات وحفظها على سطح المكتب

**كيفية الاستخدام:**
```powershell
.\backup_database.ps1
```

**ما يحدث:**
- يتم إنشاء ملف نسخة احتياطية بالتاريخ والوقت الحالي
- يتم حفظ الملف على سطح المكتب باسم: `garb_project_backup_YYYY-MM-DD_HH-mm-ss.sql`
- يعرض حجم الملف بعد الانتهاء

### 2. restore_database.ps1
**الوظيفة:** استعادة قاعدة البيانات من نسخة احتياطية

**كيفية الاستخدام:**
```powershell
# لاستعادة النسخة الأحدث تلقائياً
.\restore_database.ps1

# لاستعادة ملف معين
.\restore_database.ps1 -BackupFile "C:\Users\ALBAR\Desktop\garb_project_backup_2025-06-28_15-30-00.sql"
```

**ما يحدث:**
- يعرض قائمة بملفات النسخ الاحتياطية المتاحة
- يمكنك اختيار الملف المطلوب أو استخدام الأحدث
- يطلب تأكيد قبل المتابعة
- يستعيد البيانات إلى قاعدة البيانات

## متطلبات النظام

### MySQL
تأكد من أن MySQL مثبت ويعمل على النظام:
- الخادم: `127.0.0.1`
- المنفذ: `3306`
- اسم المستخدم: `root`
- كلمة المرور: (فارغة)

### أدوات سطر الأوامر
تأكد من توفر هذه الأدوات في PATH:
- `mysqldump` (لأخذ النسخ الاحتياطية)
- `mysql` (لاستعادة النسخ الاحتياطية)

## نصائح مهمة

### 1. النسخ الاحتياطية التلقائية
يمكنك إنشاء مهمة مجدولة لأخذ نسخة احتياطية يومية:
```powershell
# فتح مجدول المهام
taskschd.msc
```

### 2. التحقق من النسخة الاحتياطية
بعد أخذ النسخة الاحتياطية، تأكد من أن حجم الملف منطقي (أكبر من 0 KB).

### 3. الأمان
- احتفظ بنسخ متعددة في أماكن مختلفة
- احذف النسخ القديمة بانتظام لتوفير المساحة
- لا تشارك ملفات النسخ الاحتياطية مع أشخاص غير مخولين

### 4. استكشاف الأخطاء

**خطأ: "mysqldump is not recognized"**
- تأكد من تثبيت MySQL
- أضف مجلد MySQL bin إلى متغير PATH

**خطأ: "Access denied"**
- تحقق من اسم المستخدم وكلمة المرور
- تأكد من أن MySQL يعمل

**خطأ: "Database does not exist"**
- تأكد من وجود قاعدة البيانات `garb_project`
- قم بتشغيل migration أولاً: `php artisan migrate`

## أمثلة عملية

### إنشاء نسخة احتياطية يومية
```powershell
# إنشاء مهمة للتشغيل يومياً في الساعة 2 صباحاً
$action = New-ScheduledTaskAction -Execute "PowerShell.exe" -Argument "-File 'C:\path\to\backup_database.ps1'"
$trigger = New-ScheduledTaskTrigger -Daily -At 2AM
Register-ScheduledTask -Action $action -Trigger $trigger -TaskName "GarbProjectBackup"
```

### نسخ الملفات إلى مجلد خارجي
```powershell
# نسخ جميع النسخ الاحتياطية إلى USB أو مجلد شبكة
Copy-Item "C:\Users\ALBAR\Desktop\garb_project_backup_*.sql" "E:\Backups\" -Force
```

## الدعم
للحصول على مساعدة إضافية، راجع وثائق Laravel أو اتصل بفريق التطوير.
